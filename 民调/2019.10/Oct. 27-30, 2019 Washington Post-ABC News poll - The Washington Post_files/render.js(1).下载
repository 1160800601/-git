(function($){var env=wp_pb.environment||"production";var isActive=wp_pb.desktopNotifications=="on";var reg,messaging,firebaseConfig,vapidKey,subscribeURL,unSubscribeURL,authHeader,sessionCount="push_notif_session_count",subscribedToPusherman="push_notif_subscribed",isSubscribed=window.localStorage.getItem(subscribedToPusherman)?true:false,snsToken=localStorage.getItem("push_notification_token");var Notifications={init:function(){if(isActive){var width=window.innerWidth>0?window.innerWidth:screen.width;
var is_safari=navigator.userAgent.indexOf("Safari")>-1&&navigator.userAgent.indexOf("Chrome")==-1;$(".pb-f-page-push-notifications").addClass("hide");if(width>400&&!is_safari){Notifications.setUpEndpoints();Notifications.initServiceWorker()}}},setUpEndpoints:function(){if(env=="production"){firebaseConfig={messagingSenderId:"336517036152"};vapidKey="BKj1hfEzXD0JPL2yVayWHdDUu6zF_ArzpyY-vIjjl7e7gppatKZkWV5qM_0fGft3yn2hYPdad_eGmBh7ZsJVj8A";authHeader="Basic cHVzaGVybWFuX3Byb2RfdXNlcjpwcjBkLXB1c2gzcm00bi1wYSQk"}else{firebaseConfig=
{messagingSenderId:"948590696263"};vapidKey="BDzucLtho-onoCfVk5TFlsNvZ9qCJTYZdWqM6r568ZKe-fFMsh2XHAVvR5cdhyz6d6S58hgAL1bz3jbQaY223pg";authHeader="Basic cHVzaGVybWFuX2Rldl91c2VyOnBXLUQzdi11czNyLTE\x3d"}var isLocal=location.host=="localhost"?"https://pb-dev-ext.digitalink.com":"";subscribeURL=isLocal+"/pusherman/subscribe-to-topic";unSubscribeURL=isLocal+"/pusherman/topic-unsubscribe"},initServiceWorker:function(){if("serviceWorker"in navigator)wp_pb&&wp_pb.StaticMethods&&wp_pb.StaticMethods.registerServiceWorker().then(function(serviceWorkerRegistration){reg=
serviceWorkerRegistration;Notifications.debug("Service Worker is ready :^)",serviceWorkerRegistration)}).then(function(){return new Promise(function(resolve){var messagingScript=document.createElement("script");messagingScript.type="text/javascript";messagingScript.src="/resources/js/firebase/firebase.js";var firebaseMessagingScript=document.getElementsByTagName("script")[0];firebaseMessagingScript.parentNode.insertBefore(messagingScript,firebaseMessagingScript);messagingScript.onload=function(){resolve()}})}).then(function(){Notifications.initUI();
Notifications.checkForPermission()})["catch"](function(error){Notifications.debug("Service Worker Error :^(",error)})},checkForPermission:function(){if(Notification.permission==="default"){var session=window.sessionStorage.getItem(sessionCount),sessionIntVal=session?parseInt(session):0;window.sessionStorage.setItem(sessionCount,++sessionIntVal);if(sessionIntVal%3==0)Notifications.showNativePopup()}},showNativePopup:function(){setTimeout(function(){Notifications.sendCustomTrackProps("notifications ask",
"notifi_ask")},5E3);Notification.requestPermission(function(permission){Notifications.showBellPopup();if(permission==="granted")Notifications.sendCustomTrackProps("notifications allowed","notifi_allowed");else if(permission==="denied"){Notifications.unsubscribe();Notifications.sendCustomTrackProps("notifications blocked","notifi_blocked")}else if(permission=="default")Notifications.sendCustomTrackProps("notifications dismissed","notifi_dismissed")})},initFirebaseApi:function(){if(!firebase.apps.length){firebase.initializeApp(firebaseConfig);
messaging=firebase.messaging();messaging.useServiceWorker(reg);messaging.usePublicVapidKey(vapidKey)}else messaging=firebase.messaging();messaging.requestPermission().then(function(){return Notifications.getToken()})["catch"](function(err){Notifications.debug("Unable to get permission to notify.",err)});messaging.onMessage(function(payload){console.table(payload);var body=payload.notification.body;var click_action=payload.notification.click_action;var icon=payload.notification.icon;var n=new Notification("Breaking News",
{body:body,icon:icon});n.onclick=function(){window.open(click_action,"_blank");n.close()}})},getToken:function(){return messaging.getToken().then(function(currentToken){Notifications.debug("Current token: ",currentToken);if(!isSubscribed)Notifications.subscribe(currentToken)})["catch"](function(err){Notifications.debug("An error occurred while retrieving token. ",err)})},subscribe:function(currentToken){var data={token:currentToken};$.ajax({type:"POST",headers:{Authorization:authHeader,"Content-Type":"application/json"},
url:subscribeURL,data:JSON.stringify(data)}).done(function(){if(currentToken){window.localStorage.setItem(subscribedToPusherman,true);isSubscribed=true;Notifications.showBellPopup()}})},unsubscribe:function(){messaging.getToken().then(function(currentToken){messaging.deleteToken(currentToken);var data={token:currentToken};$.ajax({type:"POST",headers:{Authorization:authHeader,"Content-Type":"application/json"},url:unSubscribeURL,data:JSON.stringify(data)}).done(function(){window.localStorage.removeItem(subscribedToPusherman);
window.localStorage.removeItem("push_notification_token");isSubscribed=false;Notifications.showBellPopup()})})},initUI:function(){$(".notifications-container .permission-request .notify-action.yes").click(function(){if(Notification.permission==="denied")Notifications.showRequestPermission();else{Notifications.sendCustomTrackProps("notifications turn on","notifi_bell-turnon");Notifications.initFirebaseApi()}});$(".notifications-container .turn-off").click(function(){Notifications.sendCustomTrackProps("notifications turn off",
"notifi_bell-turnoff");Notifications.unsubscribe();return false});$(".notifications-container .notify-action.not-now").click(function(){Notifications.hideAll()});$(".notify-ic").click(function(){if($(this).hasClass("bell-opened")){Notifications.hideAll();return}Notifications.showBellPopup()});$(document).mouseup(function(e){var container=$(".notifications-container");if(!container.is(e.target)&&container.has(e.target).length===0&&(!$(".notification-items").hasClass("hide")||!$(".permission-request").hasClass("hide")))Notifications.hideAll()});
wp_pb.register("nav","finish_close",function(){if(!$(".notification-items").hasClass("hide")||!$(".permission-request").hasClass("hide"))Notifications.hideAll()});if(Notification.permission==="granted"&&(isSubscribed||snsToken))Notifications.initFirebaseApi();var $headerNotifications=$(".pb-f-page-push-notifications .notifications-container").removeClass("hidden");var $betaContainer=$("#beta-container");if($betaContainer.length>0)$betaContainer.after($headerNotifications);else $(".pb-f-page-header-v2 .sign-up-buttons").after($headerNotifications)},
showBellPopup:function(){if($(".pb-f-posttv-live-bar").height())$(".notifications-top-arrow").addClass("gear-bar");else $(".notifications-top-arrow").removeClass("gear-bar");Notifications.sendCustomTrackProps("notifications bell open","notifi_bell-open");if(Notification.permission==="granted"&&isSubscribed)Notifications.showNotifications();else Notifications.showRequestPermission()},showRequestPermission:function(){if(Notification.permission==="denied")Notifications.loadInstructionsImg().done(function(){$(".notifications-container .permission-request .permission-default").addClass("hide");
$(".notifications-container .permission-request .permission-denied").removeClass("hide");$(".permission-request").removeClass("hide");$(".notify-ic").addClass("bell-opened");Notifications.sendCustomTrackProps("notifications blocked","notifi_blocked")});else{$(".notifications-container .permission-request .permission-default").removeClass("hide");$(".notifications-container .notification-items .permission-denied").addClass("hide");$(".permission-request").removeClass("hide");$(".notify-ic").addClass("bell-opened")}},
showNotifications:function(){$(".notifications-container .notification-items").removeClass("hide");$(".notifications-container .permission-request").addClass("hide");$(".notify-ic").addClass("bell-opened");if(!$(".notif-number").hasClass("hide"))$(".notif-number").addClass("hide")},loadInstructionsImg:function(){if(!$.trim($(".permission-denied").html()).length){var noticeurl="/pb/api/v2/render/feature/page/push-notifications?shownotice\x3dshownotice";return $.get(noticeurl,function(data){var rootEl=
$(data.rendering);var permissionText=rootEl.find(".permission-denied-text");$("#nav-bar").find(".permission-denied").append(permissionText);var permissionImage=rootEl.find(".permission-denied-img");$("#nav-bar").find(".permission-denied").append(permissionImage)})}else return jQuery.Deferred().resolve()},hideAll:function(){$(".notif-number, .notification-items, .permission-request").addClass("hide");$(".notify-ic").removeClass("bell-opened")},trackProps:function(value){var props={pageName:window.wp_page_name,
eVar1:window.wp_page_name,prop2:window.wp_subsection,eVar2:window.wp_channel,prop3:window.wp_content_type,eVar17:window.wp_content_type};props.eVar26=value;return props},sendCustomTrackProps:function(name,value){if(window.s)window.s.sendDataToOmniture(name,"event80",Notifications.trackProps(value),{wait:true})},debug:function(){if(window.location.href.indexOf("debug\x3dtrue",0)>0)console.log(Array.prototype.join.call(arguments," "))}};if(wp_pb.StaticMethods.isPageHydrated())Notifications.init();__e.push(["shamble",
function(){Notifications.init()}])})(jQuery);
(function magnetAnonymous(window,$,wp_pb){var SCROLL_INTERVAL=200;var DEFAULT_DEBOUNCE=100;var UP_OFFSET=-175;var DOWN_OFFSET=0;var WINDOW_TOP_OFFSET=0;var SCREEN_BOTTOM_OFFSET=600;logMagnetTag();$(function(){var $w=$(window);var $d=$(document);var $r=$("html");var $instance=$(".pb-f-page-magnet");$instance.each(function(){var $el=$(this);init($el)});function init($container){var $modulearea=$container.find(".pb-module-area");if($modulearea.length>0)$container.addClass("magnet-container");var $isMobile=
$("html").hasClass("mobile");if($isMobile)makeTitle().insertBefore(".pb-f-page-magnet").addClass("mb-title");else{makeTitle().insertAfter(".pb-magnet-controls").addClass("desk-title");$(".desk-title").addClass("showInlineBlock")}var $ctrl={};$ctrl.$container=$container.find(".pb-magnet-controls");$ctrl.$mvleft=$ctrl.$container.find(".pb-magnet-mvleft");$ctrl.$mvright=$ctrl.$container.find(".pb-magnet-mvright");$container.data("magnetControl",$ctrl);var $title=$modulearea.find(".pb-magnet-title");
applyTitleCase($title.find(".pb-magnet-h2.magnet-title-case"));$modulearea.find('[data-pb-magnet-first\x3d"true"]').insertAfter($title);var $items=$container.find(".pb-magnet-item");var $imgs=$items.find(".pb-magnet-article-image");if($items.length==0)return;var tagname=$modulearea.data("tag");var omniParams=params($modulearea.data("omni"));tagLinks(omniParams);attachNavEvents();$modulearea.css("display","");function attachNavEvents(){applyLazyload();var edown="mousedown.magnet";if(!touchDevice()){containerScroll(function(){applyNavVisibility()});
$ctrl.$mvleft.off(edown).on(edown,function(){var value=Math.max(0,$container.scrollLeft()-computeWidth());moveScroll(value)});$ctrl.$mvright.off(edown).on(edown,function(){var value=$container.scrollLeft()+computeWidth();moveScroll(value)});registerOnce("nav","start_open",debounce(function(){down()},DEFAULT_DEBOUNCE,true))}else windowTop(function(){if(WINDOW_TOP_OFFSET>=$w.scrollTop())down()});registerOnce("nav","start_close",debounce(function(){up()},DEFAULT_DEBOUNCE,true));registerOnce("magnet",
"start_open",debounce(function(){if(tagname&&!!window.s)s.sendDataToOmniture("magnet_open","",{prop72:tagname})},DEFAULT_DEBOUNCE,true));function computeWidth(){var winwidth=$w.width();var itemwidth=$items.first().width();return Math.floor(winwidth/itemwidth)*itemwidth}}function params(value){var params=value?value.split("\x26"):[value];var result=[];if(params.length>0)$.each(params,function(index,value){var param=value.split("\x3d");result.push(param)});return result}function tagLinks(params){$modulearea.find("a").each(function(){var $a=
$(this);var url=$a.attr("href");$.each(params,function(index,param){url=updateUrlParam(url,param[0],param[1])});$a.attr("href",url)})}function registerOnce(arg1,arg2,fn){var regdata=[arg1,arg2];var regname=regdata.join(":");if(!$container.data(regname))wp_pb.register(regdata[0],regdata[1],fn);$container.data(regname,true)}function applyNavVisibility(){$ctrl.scrollleft=$container.scrollLeft();$ctrl.leftoffset=$container.scrollLeft()+$container.width();var rightbound=$modulearea[0].offsetWidth-$ctrl.leftoffset<=
0;$ctrl.$mvleft.toggle(!!$ctrl.scrollleft);$ctrl.$mvright.toggle(!rightbound)}function applyLazyload(){var sename="scroll.magnet-lazy";var reveal=0;$container.off(sename).on(sename,debounce(function(){lazy()},1,true));lazy();function lazy(){var count=Math.max(reveal,computeNumberOfImages());if(!!count&&"NaN"!==count.toString()&&reveal!==count){reveal=count;$imgs.filter(":lt("+reveal+")").each(function(){var $el=$(this);$el.attr("src",$el.data("original"))})}}function computeNumberOfImages(){return Math.ceil(($container.scrollLeft()+
($container.width()||$(window).width()))/$items.first().width())}}function nearBottom(){return $w.scrollTop()>=$d.height()-$w.height()-SCREEN_BOTTOM_OFFSET}function down(){$r.addClass("magnet");$(".mb-title").addClass("showBlock");if(!nearBottom())$r.addClass("magnet-nudge");if(touchDevice())$container.add(".mb-title").addClass("magnet-open");else $container.addClass("magnet-open").css({top:DOWN_OFFSET});wp_pb.report("magnet","start_open")}function up(){$r.removeClass("magnet magnet-nudge");$(".mb-title").removeClass("showBlock");
if(touchDevice())$container.add(".mb-title").removeClass("magnet-open");else $container.removeClass("magnet-open").css({top:UP_OFFSET});wp_pb.report("magnet","start_close")}function containerScroll(fn){var scroll;var rename="resize.magnet";$w.off(rename).on(rename,function(){scroll=true});var sename="scroll.magnet";$container.off(sename).on(sename,function(){scroll=true});var tid;setInterval(function(){if(scroll){if(tid)clearTimeout(tid);tid=setTimeout(function(){fn()},SCROLL_INTERVAL)}scroll=false},
SCROLL_INTERVAL)}function getTitleHtml(){return $("#PageMagnetTitle").html()}function makeTitle(){return $(getTitleHtml())}function windowTop(fn){var atop=false;var tid;var sename="scroll.magnet";$w.off(sename).on(sename,function(){var top=$(window).scrollTop();if(!atop&&top==0){atop=true;if(tid)clearTimeout(tid);tid=setTimeout(function(){fn()},SCROLL_INTERVAL)}else if(top>=0)atop=false})}function moveScroll(value){$container.stop().animate({scrollLeft:value},"slow")}}function touchDevice(){return $r.hasClass("touch")}
});function titleCase(strValue){var str=strValue.replace(/([^\W_]+[^\s-]*) */g,function(txt){return txt.charAt(0).toUpperCase()+txt.substr(1).toLowerCase()});var lowers=["A","An","The","And","But","Or","For","Nor","As","At","By","For","From","In","Into","Near","Of","On","Onto","To","With"];var i,j;for(i=0,j=lowers.length;i<j;i++)str=str.replace(new RegExp("\\s"+lowers[i]+"\\s","g"),function(txt){return txt.toLowerCase()});var uppers=["Id","Tv"];for(i=0,j=uppers.length;i<j;i++)str=str.replace(new RegExp("\\b"+
uppers[i]+"\\b","g"),uppers[i].toUpperCase());return str}function applyTitleCase($el){var title=titleCase(($el.text()||"").replace(/_/gi," "));$el.text(title)}function updateUrlParam(url,key,value){var n=new RegExp("([?\x26])"+key+"\x3d.*?(\x26|$)","i");var i=-1!==url.indexOf("?")?"\x26":"?";return url.match(n)?url.replace(n,"$1"+key+"\x3d"+value+"$2"):url+i+key+"\x3d"+value}function logMagnetTag(){var tagname;var modulearea=document.getElementsByClassName("pb-f-page-magnet")[0].getElementsByClassName("pb-module-area")[0];
tagname=modulearea&&modulearea.getAttribute("data-tag");if(tagname&&!!window.s)s.prop55=tagname}function debounce(func,wait,immediate){var timeout;return function(){var context=this,args=arguments;var later=function(){timeout=null;if(!immediate)func.apply(context,args)};var callNow=immediate&&!timeout;clearTimeout(timeout);timeout=setTimeout(later,wait);if(callNow)func.apply(context,args)}}})(window,jQuery,wp_pb);
(function(){__e=window.__e||[];var $w=$(window),logger=!!window.TWP&&!!TWP.Tools&&!!TWP.Tools.logger?new TWP.Tools.logger("pb-f-sharebars-top-share-bar"):window.console;try{var socialTools={myRoot:".top-sharebar-wrapper",init:function(){$(".pb-f-sharebars-top-share-bar").each(function(index,root){if(!wp_pb.BrowserInfo.desktop&&!$(root).find(".top-sharebar-wrapper").data("pb-prevent-ajax")&&$(root).find(".vertical-sticky-top-sharebar").length==0){var contentUriPath=$(root).find(".top-sharebar-wrapper").data("pb-canonical-url");
if(contentUriPath.indexOf(".washingtonpost.com")>=0)$.ajax({url:"/pb/api/v2/render/feature",dataType:"json",data:{id:$(root)[0].id,uri:window.location.pathname,contentUri:contentUriPath,desktop:wp_pb.BrowserInfo.desktop,mobile:wp_pb.BrowserInfo.mobile},cache:true,jsonCallback:"wpTopShareBarAjax",success:function(data){$(root).empty();$(root).append($(data.rendering).children());socialTools.originalInit()},error:function(data){socialTools.originalInit()}});else socialTools.originalInit();$(root).find(".top-sharebar-wrapper").data("pb-prevent-ajax",
"true")}else socialTools.originalInit()})},originalInit:function(myRoot){var self=this;myRoot=myRoot||this.myRoot;$myRoot=$(myRoot);if($myRoot.hasClass("sticky-top-sharebar"))stickyHorizontalShareBar.init();$myRoot.each(function(index,myRootElement){if($(myRootElement).hasClass("vertical-sticky-top-sharebar"))stickyVerticalShareBar.init($(myRootElement));var $root=$(myRootElement),$individualTool=$(".tool:not(.more, .read-later-bookmark, .read-later-list, .share-flyout, .save)",$root),$socialToolsWrapper=
$(".social-tools-wrapper",$root),$socialToolsMoreBtn=$(".tool.more",$socialToolsWrapper),$socialToolsAdditional=$(".social-tools-additional",$root),width=window.innerWidth>0?window.innerWidth:screen.width,isMobile=mobile_browser===1&&width<480?true:false;$socialToolsMoreBtn.off("click").on("click",this,function(ev){$socialToolsMoreBtn.hide();$socialToolsAdditional.show("fast",function(ev){$root.addClass("expanded");$(".social-tools",$socialToolsAdditional).animate({"margin-left":0},4250)}).addClass("more-open")});
$individualTool.off("click");$individualTool.on({click:function(event){var shareType=$(this).attr("class");var eVar1=$(this).data("evar1");shareType=typeof shareType!="undefined"?shareType.split(" ")[0].trim():"";self.trackTraffic("share."+shareType,shareType+"_bar",eVar1)}});if(wp_pb&&wp_pb.BrowserInfo&&wp_pb.BrowserInfo.tablet)$root.addClass("tablet");if(wp_pb.BrowserInfo.mobile&&$root.find(".vertical-sticky-top-sharebar").length>0){var calcMobileIcons=function(){var width=$root.find(".social-tools-wrapper").width()-
5;var shareIconWidth=Math.ceil($root.find(".social-tools-primary .social-tools .tool").first().outerWidth(true));$root.find(".social-tools-primary .social-tools .tool.more").hide();var allShare=$root.find(".social-tools-primary .social-tools .tool:not(.more), .social-tools-additional .social-tools .tool").hide();if($root.find(".social-tools-readlater").length>0)width=width-Math.ceil($root.find(".social-tools-readlater").width());var numShare=Math.floor(width/shareIconWidth);for(var share=0;share<
allShare.length;share++)try{if(share<numShare)$(allShare.get(share)).fadeIn();else $(allShare.get(share)).hide()}catch(e){}};$(window).resize(function(){calcMobileIcons()});calcMobileIcons()}else $root.find(".social-tools-primary .social-tools .tool").fadeIn();$root.removeClass("unprocessed")});if(typeof wp_pb.StaticMethods.initReadLater=="function")wp_pb.StaticMethods.initReadLater($myRoot,"top-share-bar")},trackTraffic:function(name,eVar27,eVar1){if(typeof window.sendDataToOmniture==="function"){var omnitureVars=
{eVar1:typeof eVar1!="undefined"?eVar1:typeof window.s=="object"&&s&&s.eVar1,eVar2:typeof window.s=="object"&&s&&s.eVar2,eVar8:typeof window.s=="object"&&s&&s.eVar8,eVar17:typeof window.s=="object"&&s&&s.eVar17,eVar27:eVar27};try{sendDataToOmniture(name,"event6",omnitureVars)}catch(e){}}},getSnowflake:function(){var currentSnowflake=TWP.Analytics&&TWP.Analytics.Snowflake?TWP.Analytics.Snowflake.getCurrent():{};return currentSnowflake.outgoing||""}};var stickyVerticalShareBar={init:function($myRoot){if($("#article-full-width-content").length===
0)$myRoot.closest(".pb-f-sharebars-top-share-bar").insertBefore("#pb-root");if(window.innerWidth>992){$myRoot.css({top:($w.height()-$myRoot.outerHeight()+25)/2+"px"});$myRoot.animate({left:"-1px"});$w.resize(function(){$myRoot.animate({top:($w.height()-$myRoot.outerHeight()+25)/2+"px"},50)})}stickyVerticalShareBar.enableCollisionDetection($myRoot);wp_pb.register("sticky-vertical-sharebar","collides_with_main_content",function(collides){$myRoot.closest(".pb-f-sharebars-top-share-bar").css("opacity",
collides?"0":"").css("pointer-events",collides?"none":"inherit")});wp_pb.register("magnet","start_open",function(){$myRoot.animate({top:($w.height()-$myRoot.outerHeight()+$(".pb-f-page-magnet .pb-module-area").height()+25)/2+"px"},50)});wp_pb.register("magnet","start_close",function(){$myRoot.animate({top:($w.height()-$myRoot.outerHeight()+25)/2+"px"},50)});wp_pb.register("nav","menu_start_open",function(){$myRoot.hide();$myRoot.css("left","-"+$myRoot.outerWidth()+"px")});wp_pb.register("nav","menu_finish_close",
function(){if(window.innerWidth>992)setTimeout(function(){$myRoot.show();$myRoot.animate({left:"-1px"})},100)})},enableCollisionDetection:function(supported){var INTERVAL_MS=600;var MAX_INTERVALS=3;var intervalCount=0;return function($myRoot){var job;if(!supported||intervalCount>MAX_INTERVALS)return;var collisionSelector=$myRoot.closest("[data-collision-selector]").attr("data-collision-selector");job=setInterval(function(){var $sb=$myRoot.closest(".pb-f-sharebars-top-share-bar");var $sbw=$sb.find(".top-sharebar-wrapper");
var $collisionEl=$(collisionSelector);var $mc=$collisionEl.length?$collisionEl:$("html").hasClass("gallery_story")?$(".pb-f-gallery-gallery"):$("#main-content");var oldcollides=$sb.data("__mccollides");var newcollides={value:undefined};if(!$sb.length||!$sbw.length||!$mc.length)clearInterval(job);else{$mc.each(function(){newcollides.value=newcollides.value||collision(this,$sbw[0])});if(!oldcollides||newcollides.value!==oldcollides.value){wp_pb.report("sticky-vertical-sharebar","collides_with_main_content",
newcollides.value);$sb.data("__mccollides",{value:newcollides.value})}}},INTERVAL_MS);intervalCount++;function collision(element1,element2){var rect1=element1.getBoundingClientRect(),rect2=element2.getBoundingClientRect();return!(rect1.top>rect2.bottom||rect1.right<rect2.left||rect1.bottom<rect2.top||rect1.left>rect2.right)}}}("getBoundingClientRect"in document.documentElement)};var stickyHorizontalShareBar={setElmTop:function($sharebarElm,y){var style=y?"translate3d(0px, "+y+"px, 0px)":"initial";
$sharebarElm.css({transform:style})},navMenuToggle:function($sharebarElm){wp_pb.register("nav","finish_open",function(){this.setElmTop($sharebarElm,0)},this);wp_pb.register("nav","finish_close",function(){this.setElmTop($sharebarElm,-50)},this);wp_pb.register("magnet","start_open",function(){},this)},fixedPosition:function($sharebarElm,sharebarTop){var currentTop=$w.scrollTop();if(currentTop>sharebarTop){if(!$sharebarElm.hasClass("top-sharebar-fixed")){$sharebarElm.addClass("top-sharebar-fixed");
wp_pb.report("sticky-top-sharebar","sharebar_fixed",true)}}else{$sharebarElm.removeClass("top-sharebar-fixed");wp_pb.report("sticky-top-sharebar","sharebar_unfixed",true)}},moveOutOfRoot:function($sharebarElm){var $pbRoot=$("#pb-root");if($pbRoot.css("max-width")!=="none"){var $sharebarRoot=$sharebarElm.parent();var $leaderboard=$(".pb-f-ad-leaderboard");$sharebarRoot.find(".sticky-top-sharebar").css("padding-top","55px");$pbRoot.before($sharebarRoot);$pbRoot.before($leaderboard)}},detectMobileForSMS:function(){if(mobile_browser){var shareString=
"";if(windows_browser)shareString="sms://?body\x3d";else if(android_browser||android233_browser)shareString="sms:?body\x3d";if(shareString.length>0)$(".pb-f-sharebars-top-share-bar .sms-share-device.unprocessed").each(function(){$(this).attr("onclick",$(this).attr("onclick").replace(/sms:\?&body=/g,shareString));$(this).removeClass("unprocessed")});else $(".pb-f-sharebars-top-share-bar .sms-share-device.unprocessed").removeClass("unprocessed")}},init:function(){var $sharebarElm=$(".sticky-top-sharebar"),
self=this;if(!$sharebarElm.length)return;this.moveOutOfRoot($sharebarElm);var sharebarTop=$sharebarElm.offset().top;var $header=$("#wp-header");if($header.css("position")==="fixed"&&$w.scrollTop()>sharebarTop)this.fixedPosition($sharebarElm,sharebarTop);$w.off("scroll.sharebar").on("scroll.sharebar",function(){self.fixedPosition($sharebarElm,sharebarTop)});$(function(){self.navMenuToggle($sharebarElm)});this.detectMobileForSMS()}};var userId=document.cookie.match(/wapo_login_id=([^;]+)/)?RegExp.$1:
"";var userSecureId=document.cookie.match(/wapo_secure_login_id=([^;]+)/)?RegExp.$1:"";var userAgent=navigator.userAgent;var textResizer={currIncrementMax:9,currIncrementUnit:2,currIncrementIndex:0,init:function(myRoot,resizeableElementList,clickElement){myRoot=myRoot||"#article-body article, .related-story, .liveblog-intro, #liveblog-story-list .description, #full-recipe .article-content";resizeableElementList=resizeableElementList||"p, li";clickElement=clickElement||".tool.textresizer";this.root=
$(myRoot);this.resizeableElements=$(resizeableElementList,this.root);if($(".related-story").prev("h3").length>0){this.resizeableElements.push($(".related-story").prev("h3"));this.resizeableElements.push($(".related-story h4 a"))}$(clickElement).on("click",this,this.resize)},resize:function(event){var currObj=event.data;if(currObj.currIncrementIndex==currObj.currIncrementMax){currObj.currIncrementIndex=0;currObj.currIncrementUnit=currObj.currIncrementUnit==2?-2:2}currObj.currIncrementIndex=currObj.currIncrementIndex+
1;currObj.resizeableElements.each(function(){elm=$(this);currSize=parseFloat(elm.css("font-size"),5);var result=currSize+currObj.currIncrementUnit;elm.css("font-size",result);wp_pb.report("textresizer","resized",result)})}};var trackTraffic=function(name){if(typeof window.sendDataToOmniture==="function"){var omnitureVars={eVar1:typeof window.s=="object"&&s&&s.eVar1,eVar2:typeof window.s=="object"&&s&&s.eVar2,eVar8:typeof window.s=="object"&&s&&s.eVar8,eVar17:typeof window.s=="object"&&s&&s.eVar17,
eVar27:name};try{sendDataToOmniture(name+".click","event6",omnitureVars)}catch(e){}}};var lifecycle={init:function(){$(".social-tools-wrapper .tool.textresizer, .social-tools-wrapper .tool.print").on("click",function(){var name=$(this).attr("class").split(" ")[0].trim();trackTraffic(name)});window.TWP=TWP||{};TWP.SocialTools=TWP.SocialTools||socialTools;TWP.SocialTools.init();TWP.TextResizer=TWP.TextResizer||textResizer;TWP.TextResizer.init();if($(".tool.comments")){var commentSystem=$(".tool.comments .coral-counter").length>
0?"coral":"echo";wp_pb.report("comment_count_target","init",{targetName:"#share_comment_count",targetUrl:$("#share_comment_count").attr("guid"),commentSystem:commentSystem})}var tablet=isMobile.tablet();if(!!window.VisitorSegment)window.VisitorSegment&&VisitorSegment("tablet",function(){return tablet&&$w.width()>768})}};if(wp_pb.StaticMethods.isPageHydrated())lifecycle.init();__e.push(["shamble",function(){lifecycle.init()}])}catch(err){logger.error(err)}})();
(function($,TWP){var AD_LOAD_TIMER=2E3;var AD_MIN_VISIBLE=4E3;var ANIM_SPEED=250;var console=new TWP.Tools.logger("leaderboard");if($(".layout_article #pb-root .pb-f-ad-leaderboard.full").length);var applyStickiness=function(){var isLoginUser=document.cookie.match(/wapo_secure_login_id=([^;]+)/)?RegExp.$1:"";if(wp_pb.BrowserInfo&&wp_pb.BrowserInfo.tablet||isLoginUser)return;$(function(){var $html=$("html"),$feature=getFeature().find(".leaderboard"),$window=$(window),timer,slotId="slug_leaderboard",
$slotAd=$feature.find("#"+slotId),$closeBtn=$feature.find(".leaderboard-close");if(!$feature.length)return;function removeSticky(){setTimeout(function(){console.log("remove sticky leaderboard.");$feature.slideUp(ANIM_SPEED,function(){$html.removeClass("lb-persist-top-true");$feature.slideDown(ANIM_SPEED)})},AD_MIN_VISIBLE)}function applySticky(){if($window.scrollTop()>100)$html.addClass("lb-persist-top-true");else $html.removeClass("lb-persist-top-true")}function bindEvents(){$window.on("scroll.lb-sticky",
function(e){e.stopPropagation();applySticky();var bnbHeight=$(".pb-f-page-breaking-news-bar .breaking-news-bar").outerHeight();if(bnbHeight>0){$feature.addClass("pb-has-breaking-news");$feature.css("margin-top",bnbHeight+"px");wp_pb.register("breakingnews","close",function(){$feature.removeClass("pb-has-breaking-news");$feature.css("margin-top","")})}});wp_pb.register("nav","finish_open",function(){$feature.removeClass("pb-navheader-hidden")});wp_pb.register("nav","finish_close",function(){$feature.addClass("pb-navheader-hidden")});
$closeBtn.on("click.lb-sticky",function(){AD_MIN_VISIBLE=0;afterLoaded();if(typeof window.sendDataToOmniture==="function"){var data={pageName:window.wp_page_name,eVar1:window.wp_page_name,prop2:window.wp_subsection,eVar2:window.wp_channel,prop3:window.wp_content_type,eVar17:window.wp_content_type,eVar26:"leaderboard-close"};window.sendDataToOmniture("leaderboard-close","event80",data)}})}function afterLoaded(){var $featureContainer=getFeature();if($feature.height()>$featureContainer.outerHeight())$featureContainer.height($feature.height()+
30);$feature.addClass("leaderboard-ad-loaded");$window.off("scroll.lb-sticky");if($html.hasClass("lb-persist-top-true"))removeSticky()}function afterAdInserted(){timer=setTimeout(function(){console.log("from second timeout: prevent ad load fail.");afterLoaded()},6E3);if(window.googletag&&window.googletag.pubadsReady)window.googletag.pubads().addEventListener("slotRenderEnded",function(event){console.log("ad slot: "+event.slot.getSlotElementId()+" inserted success");if(event.slot.getSlotElementId()===
slotId){clearTimeout(timer);setTimeout(function(){console.log("leaderboard ad load success.");afterLoaded()},AD_LOAD_TIMER)}})}applySticky();bindEvents();setTimeout(function(){$closeBtn.addClass("fa-remove")},6E3);if($slotAd.children().length)timer=setTimeout(function(){console.log("from first timeout: if ad is already loaded");afterLoaded()},AD_LOAD_TIMER);$feature.on("DOMNodeInserted",function(e){var $el=$(e.target),id=$el.attr("id");if($el.is("iframe")&&id&&!/(hidden)/g.test(id)){clearTimeout(timer);
$feature.off("DOMNodeInserted");afterAdInserted()}});$feature.on("disableSticky.lb-sticky",function(){clearTimeout(timer);$window.off("scroll.lb-sticky");$feature.off("DOMNodeInserted");$html.removeClass("lb-persist-top-true");TWP.Features.Ad.Leaderboard.sticky=false})})};if(TWP&&TWP.Features&&TWP.Features.Ad&&TWP.Features.Ad.Leaderboard&&!!TWP.Features.Ad.Leaderboard.sticky)applyStickiness();if(TWP&&TWP.Features&&TWP.Features.Ad&&TWP.Features.Ad.Leaderboard&&!!TWP.Features.Ad.Leaderboard.belowSharebar)applySharebarPosition();
$(window.document).on("abtest-ready",function(e,ABT){var test=ABT.get("ads-leaderboard");getFeature().attr("moat-test-id",[getFeature().attr("moat-id")||"unknown/unknown",test.name||"control"].join("-"));if(test.is("below_sharebar"))applySharebarPosition();if(test.is("sticky"))applyStickiness()});function applySharebarPosition(){var $leaderboard=getFeature();var $shareBar=getSharebar();$leaderboard.addClass("after-sharebar-leaderboard");return $leaderboard.insertAfter($shareBar)}function getFeature(){return $(".pb-f-ad-leaderboard")}
function getSharebar(){return $(".pb-f-sharebars-top-share-bar")}})(jQuery,TWP);
(function($){var console=new TWP.Tools.logger("storytools");var disableEvents=true;var feature={init:function(){this.$note=$("#note");this.$refLinks=this.$note.find("a");this.$refLinks.attr("target","_blank");this.noteId=this.$note.data("noteId");this.data=JSON.parse($("#note_"+this.noteId)[0].innerHTML);this.sendStats();this.mobileView();this.removeEmptyHtmlTags();var self=this;window.onresize=function(){self.mobileView()}},sendStats:function(){var note=this.data.game;var question=note.questions[0]||
{};try{if(!disableEvents){var opts={gameId:note.gameId,action:"load",metaData:{}};WPGames.stats.logActivity(opts,"note")}WPGames.stats.omnitureEvent({feature:"notes-canonical",event:"load",gameId:note.gameId,questionId:question.questionId,name:question.questionTitle||note.title,author:note.createdBy,section:note.sectionId,subSection:note.subSection})}catch(ex){console.error(ex)}},removeEmptyHtmlTags:function(){$("#note").find("p:empty").hide();var $p=$("#note").find("p");$p.each(function(index,item){if(item.innerHTML===
"\x3cbr\x3e")item.style.display="none"})},mobileView:function(){var mediaMatches=window.matchMedia("screen and (max-width: 768px)");if(mediaMatches.matches){$("#note-description").insertAfter($("#note"));$("#article-topper").css({"padding-left":"5%","padding-right":"5%"})}else $("#article-topper").css({"padding-left":0,"padding-right":0});this.positionImg(mediaMatches)},positionImg:function(mediaMatches){var $img=document.querySelector("#note img");if($img===null)return;var imgWidth=$img.offsetWidth;
var bodyWidth=document.body.clientWidth;if(imgWidth>=bodyWidth)return;if(mediaMatches.matches){if($img.className.match(/transform-center/)===null)$img.className+=" transform-center"}else $img.className=$img.className.replace("transform-center","")}};feature.init()})(jQuery);
(function($){var __e=window.__e||[],wp_pb=window.wp_pb||{},env=wp_pb.environment||"production",moduleIndex;function Subscription($root){var moduleType,promoCode,remindLaterPromoCode,tidVal,moduleData={Trust:{headline:"Our journalism keeps watch on Washington and the world.",className:"trust",promo:"_d_am_1",hp_promo:"_d_1",tid:"usw_submod_"},Support:{headline:"Your support helps our journalists report news that matters.",className:"support",promo:"_d_am_2",hp_promo:"_d_2",tid:"usw_submod_"},Speed:{headline:"Be the first to know.",
body:"Our award-winning journalists are there when the news breaks.",className:"speed",promo:"_d_am_3",hp_promo:"_d_3",tid:"usw_submod_"},Established:{headline:"Reporting the facts for over 140 years.",className:"established",promo:"_d_am_4",hp_promo:"_d_4",tid:"usw_submod_"},Thanks:{headline:"Thank you.",body:"Your subscription supports journalism that matters.",className:"thanks",promo:"_d_am_5",hp_promo:"_d_5"}},randomNumber=function(min,max){return Math.floor(Math.random()*(max-min+1)+min)},loadPromo=
function(){var dataIndexes=["Trust","Support","Speed","Established","Thanks"];var index,data;var isUS=document.cookie.match(/wp_country=(US)\b/);var $signup=$root.find(".subscription.signup");var promoData=$signup.data("promo");var promoUSOnly=$signup.data("us_only");moduleType=$signup.data("location")||"rr";var subscribeUrl=$root.find(".rml-subscribe-link.link").attr("href"),remindLaterUrl="";if(!subscribeUrl)return;if(moduleIndex!==undefined)index=moduleIndex;else if(wp_pb&&wp_pb.StaticMethods&&
wp_pb.StaticMethods.isSubscriber())moduleIndex=index=4;else moduleIndex=index=randomNumber(0,3);if(promoData&&(!promoUSOnly||promoUSOnly&&isUS)){data={};data.headline=$signup.data("headline");data.body=$signup.data("body");data.tid=$signup.data("tid");data.offer_text=$signup.data("offer_text");data.promo=promoData;promoCode=data.promo}else{data=moduleData[dataIndexes[index]];promoCode=data[moduleType+"_promo"]?moduleType+data[moduleType+"_promo"]:moduleType+data.promo}var promoParts=promoCode.split("_");
var promoSuffix=promoParts[promoParts.length-1];var displayPrefix=promoParts[0];remindLaterPromoCode="e_r_"+displayPrefix+"_rm_"+promoSuffix;tidVal=data.tid+moduleType;var $module=$root.find(".subscription.signup").addClass(data.className);$module.find(".rml-subscribe-lang").html(data.headline);var promoTest=new RegExp("promo\x3d([^\x26]+)");var isPromo=subscribeUrl.match(promoTest);if(isPromo){subscribeUrl=subscribeUrl.replace(promoTest,"promo\x3d"+promoCode);remindLaterUrl=subscribeUrl.replace(promoTest,
"promo\x3d"+remindLaterPromoCode)}else{subscribeUrl=subscribeUrl+"?promo\x3d"+promoCode;remindLaterUrl=subscribeUrl.replace(promoTest,"promo\x3d"+remindLaterPromoCode)}var arcId=((((TWP||{}).Data||{}).Tracking||{}).props||{}).arc_id;var acqEntType=((((TWP||{}).Data||{}).Tracking||{}).props||{}).content_type;var wp_prop=window.wpMetaData?window.wpMetaData.wpPropensity:"";if(arcId)subscribeUrl+="\x26arcId\x3d"+arcId;if(acqEntType)subscribeUrl+="\x26acqEntType\x3dmktg_onsite_"+acqEntType;else subscribeUrl+=
"\x26acqEntType\x3dmktg_onsite_homepage";if(wp_prop)subscribeUrl+="\x26wp_prop\x3d"+wp_prop;$module.find(".rml-subscribe-link.link").attr("href",subscribeUrl);$module.find(".rml-subscribe-link.send-offer").attr("href",remindLaterUrl);if(data.body){var $tagline=$module.find(".rml-subscribe-tagline");$tagline.html(data.body)}if(data.offer_text)$module.find(".rml-subscribe-btn.subscribe .rml-subscribe-link").html(data.offer_text);$module.removeClass("hide")},getLocation=function(){function isInternational(_rpld1){if(_rpld1){var matches=
_rpld1.match(/20:([^|]*)/);if(matches&&matches.length>1){var country=matches[1];if(["usa","mnull","***","-1"].indexOf(country)==-1)return true}}return false}var offerType="national";var _local=$.cookie("client_region")==1;var _rpld1=$.cookie("rpld1");var _international=isInternational(_rpld1);if(_international)offerType="international";else if(_local)offerType="local";return offerType},subscribe=function(captcha_res){var email=$root.find("#subscription-input").val();var data,url,offerType=getLocation();
if(env=="production")url="https://subscribe.washingtonpost.com/subscriptionapi/remind-me-later";else url="https://subscribe.digitalink.com/subscriptionapi/remind-me-later";data={email:email,recaptchaResponse:captcha_res,offerType:offerType,promoCode:remindLaterPromoCode};$.ajax({type:"POST",dataType:"json",contentType:"application/json",url:url,data:JSON.stringify(data),success:function(data){if(data.status=="SUCCESS"){$root.find(".rml-subscribe-tagline.email").text(email);$root.find(".subscription.signup").addClass("hide");
$root.find(".subscription.success").removeClass("hide");document.dispatchEvent(new CustomEvent("twp_tracking",{detail:"subscribe_module_email"}))}else showError("Error while sending offer, please try later.")},error:function(){showError("Error while sending offer, please try later.")}})},showError=function(msg){$root.find(".email-error").text(msg).removeClass("hide");$root.find(".rml-subscribe-btn.send-offer").addClass("disabled").removeClass("active");$root.find(".rml-subscribe-btn.send-offer").find(".spinner").addClass("hide")},
subscribeProcess=function(elm){var $elm=$(elm);if($elm.hasClass("active")){$elm.find(".rml-subscribe-link.send-offer").text("Sending..");$elm.addClass("sending");$elm.find(".spinner").removeClass("hide");window.recaptcha_rml=window.grecaptcha.render("recaptcha_rml",{sitekey:"6Lf0DRoUAAAAAEawkoNEUKcpWx8eh_I7PRArTA9V",callback:subscribe,size:"invisible"});window.grecaptcha.execute(window.recaptcha_rml)}else if(!$elm.hasClass("disabled")){$root.find(".subscription.signup").find(".form-ui").removeClass("hide");
$root.find(".rml-subscribe-btn.subscribe").addClass("hide");$root.find(".subscribe-link").addClass("hide");$elm.addClass("disabled")}},initUI=function(){if(document.cookie.match(/wpnisecure=([^;]+)/))$root.find(".subscribe-link").remove();else $root.find(".subscribe-link").click(function(event){event.preventDefault();TWP.Identity.uswTid=tidVal;TWP.Identity._showSignIn()});$root.find(".rml-subscribe-btn.send-offer").click(function(event){event.preventDefault();if(typeof grecaptcha==="undefined")$.ajax({url:"https://www.google.com/recaptcha/api.js",
dataType:"script",cache:true,success:function(){var findCaptcha=setInterval(function(){if(typeof grecaptcha!=="undefined"){clearInterval(findCaptcha);subscribeProcess(event.delegateTarget)}},50)},error:function(){}});else subscribeProcess(event.delegateTarget);return false});$root.find(".form-ui.input").bind("input",function(){var re=/[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}/gim;var subscribeEmail=$(this).val();if(subscribeEmail==""||!re.test(subscribeEmail)){$root.find(".rml-subscribe-btn.send-offer").addClass("disabled").removeClass("active");
$root.find(".form-ui.input").addClass("error");$root.find(".email-error").removeClass("hide")}else{$root.find(".rml-subscribe-btn.send-offer").removeClass("disabled").addClass("active");$root.find(".form-ui.input").removeClass("error");$root.find(".email-error").addClass("hide")}return false});$root.find(".close-btn").click(function(){$root.find(".subscription").remove()})};this.init=function(){loadPromo();if(wp_pb&&wp_pb.StaticMethods&&!wp_pb.StaticMethods.isSubscriber())initUI()}}var lifecycle=
{init:function(){$(".pb-f-page-subscription-remind-later").each(function(){if(wp_pb&&wp_pb.StaticMethods&&!wp_pb.StaticMethods.isSubscriber()){var sb=new Subscription($(this));sb.init()}else $(this).remove()})}};if(wp_pb.StaticMethods.isPageHydrated())lifecycle.init();__e.push(["shamble",function(){lifecycle.init()}])})(jQuery);
(function(){function _initEverything(){var $=jQuery;var TWP=window.TWP||{};TWP.Perso=TWP.Perso||{};TWP.Perso.Tools=TWP.Perso.Tools||{};var T=TWP.Perso.Tools;var $sponsored=null;var $container=null;var $pbcontainer=null;var log=new TWP.Tools.logger("HYBRID");var validOnes=[];var clientString="recommend-strip-11";if(window["wp_meta_data"]&&window["wp_meta_data"]["isPWA"])clientString+="-pwa";try{var maxToShow=3;try{maxToShow=isNaN(window.wp_pb.recommendationEnv.REC_MAX_TO_SHOW)?maxToShow:window.wp_pb.recommendationEnv.REC_MAX_TO_SHOW}catch(e){maxToShow=
3}var client=new TWP.Perso.Recommend(clientString,maxToShow)}catch(e){}var counterPointApi=null;var canonicalPage=document.querySelectorAll("link[rel\x3dcanonical]")[0];var counterPointUrl="";var status="";var visible=false;var clickListenerAdded=false;var trackRenderedAllCalled=false;function _failure(error){log.debug("Failure",function(){$pbcontainer.hide();trackError(error);status="failed"})}function isValid(recommendation){return recommendation&&recommendation.url&&recommendation.responsetype&&
recommendation.headline&&recommendation.summary&&recommendation.photo&&recommendation.photo.path}function render(recommendations){if(!recommendations||recommendations.length==0)return _failure("no-recommendations");validOnes=[];for(var i=0;i<recommendations.length;i++)if(isValid(recommendations[i]))validOnes.push(recommendations[i]);if(validOnes.length==0)return _failure("no-valid-recommendations");log.debug("Render",function(){_renderArticle(validOnes)});status="rendered";trackVisible()}function initModal($container){var modal=
$container.find(".story-label-explainer");modal.jqm({overlayClass:"story-label-explainer",closeClass:"label-modal-close",overlay:0,onHide:function(hash){hash.w.hide()&&hash.o&&hash.o.remove();return true}});$container.find(".section-label-span").hover(function(){modal.jqmShow()});$(document).mouseup(function(e){if(!modal.is(e.target)&&modal.has(e.target).length===0)modal.jqmHide()});if(typeof window.Hammer==="function"&&wp_pb.BrowserInfo.mobile_browser)try{var hammertime=new window.Hammer($(".section-label-span")[0],
{prevent_mouseevents:true});hammertime.on("tap",handleTap)}catch(err){log.debug(err)}function handleTap(ev){ev.gesture.preventDefault();ev.gesture.stopPropagation();modal.jqmShow()}}function _renderArticle(recommendations){var idx=0;var html="";var counterHtml="";var classes="";for(var i=0;i<recommendations.length;i++)if(recommendations[i].responsetype==="hybrid_counterpoint_1_na"){log.debug("Render item ("+i+")");counterHtml=counterHtml+renderItem(recommendations[i],idx,recommendations.length);idx=
idx+1}else{log.debug("Render item ("+i+")");html=html+renderItem(recommendations[i],idx,recommendations.length);idx=idx+1}html=renderRecHtml(html,classes,"The Post Recommends");$sponsored=$("#slug_postrecommends");$sponsored.remove();if(counterHtml.length>0){counterHtml=renderRecHtml(counterHtml,"counterpoint","Counterpoint");$container.html(counterHtml);$container.append(html)}else $container.html(html);initModal($container);$container.find(".content-strip \x3e .label-wrapper").before($sponsored);
$container.show();$pbcontainer.show();$pbcontainer.after('\x3cdiv class\x3d"clear"\x3e\x3c/div\x3e');$(document).trigger("dom-manipulation-complete")}function renderRecHtml(html,classes,label){var modal="";var modalLabel="";var counterpointLabel="";if(label==="Counterpoint"){modal='\x3cdiv class\x3d"story-label-explainer arrow_box"\x3e'+'\x3ci class\x3d"fa fa-times label-modal-close" aria-hidden\x3d"true"\x3e\x3c/i\x3e'+'\x3cp class\x3d"label-title Counterpoint"\x3e'+'\x3cb class\x3d"label"\x3eCounterpoint\x3c/b\x3e '+
'\x3cspan class\x3d"label-content"\x3eAn Opinions piece that offers a different perspective from the article you\u2019re currently reading\x3c/span\x3e'+"\x3c/p\x3e"+"\x3c/div\x3e";modalLabel="section-label-span";counterpointLabel='\x3cspan class\x3d"counterpoint-explainer"\x3e\x3ci class\x3d"fa fa-circle counterpoint-label-ic" aria-hidden\x3d"true"\x3e\x3c/i\x3e A different view on the issue\x3c/span\x3e'}return'\x3cdiv class\x3d"postrecommends contentfeed '+classes+'"\x3e'+'\x3cdiv class\x3d"content-strip"\x3e'+
'\x3cdiv class\x3d"label-wrapper label-wrapper-post-recommends"\x3e'+'\x3cspan class\x3d"label label-kicker"\x3e\x3cspan class\x3d"'+modalLabel+'"\x3e'+label+"\x3c/span\x3e\x3c/span\x3e"+counterpointLabel+modal+"\x3c/div\x3e"+'\x3cdiv class\x3d"clear"\x3e\x3c/div\x3e'+html+'\x3cdiv class\x3d"clear"\x3e\x3c/div\x3e'+"\x3c/div\x3e"+"\x3c/div\x3e"}function renderURL(recommendation){var url=recommendation.url;var hostname=window.location.hostname;if(hostname.indexOf("localhost")===-1&&hostname.indexOf("wpprivate.com")===
-1&&(url.indexOf("https://www.washingtonpost.com")==0||url.indexOf("http://www.washingtonpost.com")==0)){var location=document.createElement("a");location.href=url;var path=location.pathname;if(path.indexOf("http")!==0&&path[0]!=="/")path="/"+path;url="https://"+hostname+path+"?tid\x3d"+recommendation.responsetype;return url}else return url+"?tid\x3d"+recommendation.responsetype}function renderImgURL(recommendation,w,h){var url=recommendation.photo.path;var re1=/(washingtonpost.com\/rf\/image_[^/]+\/)/;
var re2=/(washingtonpost.com\/rw?\/)/;if(url.match(re1)||url.match(re2))url=url.replace(RegExp.$1,"washingtonpost.com/rf/image_"+w+"x"+h+"/");else url="https://www.washingtonpost.com/wp-apps/imrs.php?src\x3d"+encodeURIComponent(url)+"\x26w\x3d"+w+"\x26h\x3d"+h;return url}function renderClasses(recommendation,index,total){var classes="";if(recommendation.responsetype.match(/video/))classes=classes+"video ";if(index==0)classes=classes+"first ";if(index==total-1)classes=classes+"last";return classes}
function renderItem(recommendation,index,total){var node=$($("#postrecommends-article-template").html());node.addClass(renderClasses(recommendation,index,total));var headline=node.find(".headline a");headline.html(recommendation.headline);headline.attr("href",renderURL(recommendation));var labelWrapper=node.find(".label-wrapper");var label=node.find(".label");if(recommendation["storyType"]&&recommendation["storyType"]!="News")label.text(recommendation["storyType"]);else if(recommendation["url"].indexOf("thelily.com")>
0)label.html('\x3ca href\x3d"https://www.thelily.com/"\x3e'+'\x3cimg class\x3d"lilylogo" src\x3d"https://wp-stat.s3.amazonaws.com/perso/recommendations/lily-logo.png"/\x3e'+"\x3c/a\x3e");else labelWrapper.remove();var linkImg=node.find(".photo-wrapper a");linkImg.attr("href",renderURL(recommendation));var blurb=node.find(".blurb");blurb.html(recommendation.summary);var displayDate=recommendation.displayDate||recommendation.publishedAt;if(displayDate){displayDate=wp_pb.StaticMethods.getTwitterTime(displayDate);
blurb.after('\x3cdiv class\x3d"timestamp"\x3e'+displayDate+"\x3c/div\x3e")}var img='\x3cimg alt\x3d"" src\x3d"'+renderImgURL(recommendation,480,320)+'"'+' data-hi-res-src\x3d"'+renderImgURL(recommendation,480,320)+'"'+' data-low-res-src\x3d"'+renderImgURL(recommendation,112,75)+'"'+' data-threshold\x3d"112" class\x3d"courtesy-of-the-resizer"\x3e';node.find(".photo-wrapper img").replaceWith(img);if(recommendation.responsetype.match(/video/)){var time="";if(recommendation.videoDuration&&recommendation.videoDuration>
1E3){var seconds=Math.floor(recommendation.videoDuration/1E3);var minutes=Math.floor(seconds/60);seconds=seconds%60;if(seconds<10)seconds="0"+seconds.toString();time=minutes+":"+seconds}var caption='\x3cdiv class\x3d"standalone-overlay posttv-playlist-text-play-btn"\x3e'+'\x3ca class\x3d"video-play" href\x3d"'+renderURL(recommendation)+'"\x3e'+'\x3cspan class\x3d"fa fa-play icon-left"\x3e\x3c/span\x3e\x3cspan\x3ePlay Video\x3c/span\x3e'+'\x3cspan class\x3d"duration"\x3e'+time+"\x3c/span\x3e"+"\x3c/a\x3e"+
"\x3c/div\x3e";blurb.after(caption)}return node[0].outerHTML}function clickTracker(ev){var link=this;var mClick=ev.button>0||ev.ctrlKey||ev.metaKey||ev.shiftKey;var prefetched=$(link).hasClass("pre-fetched");log.debug("Click",function(){var href=link.href;var tid=href.replace(/.*\?tid=/,"");log.debug("URL : "+href);trackClicked(client,href,tid);var newHref=href;newHref=newHref.replace(/.*wpprivate.com\/pb/,"https://www.washingtonpost.com");newHref=newHref.replace(/.*localhost:8888\/pb/,"https://www.washingtonpost.com");
if(newHref.split("?")[0]===counterPointUrl.href)serveCounterStats("clicked");if(mClick||prefetched);else setTimeout(function(){log.debug("Redirecting");document.location=href},200)});return mClick||prefetched}function trackClicks(){if(!clickListenerAdded){clickListenerAdded=true;$pbcontainer.on("click",".row a",null,clickTracker)}}function trackClicked(client,url,tid){T.Omniture.send("post_recommends","",{prop69:tid},log);client.clicked(url)}function trackVisible(){if(status=="rendered"&&visible&&
!trackRenderedAllCalled){trackRenderedAllCalled=true;var param=[];for(var i=0;i<validOnes.length;i++){param.push(validOnes[i].responsetype);if(validOnes[i].responsetype==="hybrid_counterpoint_1_na"){var parser=document.createElement("a");parser.href=validOnes[i].url;counterPointUrl=parser;serveCounterStats("served")}}var props={prop72:param.join(",")};T.Omniture.send("post_recommends","",props,log);client.rendered()}}function serveCounterStats(type){var parsedOpinion=document.createElement("a");parsedOpinion.href=
canonicalPage.href;var opinionUrl=parsedOpinion.pathname;var params="opinion_url\x3d"+opinionUrl+"\x26counterpoint_url\x3d"+counterPointUrl.pathname+"\x26stype\x3d"+type;var sReq=new XMLHttpRequest;sReq.open("POST",counterPointApi,true);sReq.setRequestHeader("Content-type","application/x-www-form-urlencoded");sReq.send(params)}function trackError(){}function _preload(){log.debug("Setting up click handlers");trackClicks();log.debug("Requesting recommendations");client.recommend().done(function(data){render(data["results"])})}
function _visible(){log.debug("Visible",function(){visible=true;trackVisible()})}function _init(){log.debug("DOM Ready",function(){try{log.debug("(Re)Init variables");status="";visible=false;trackRenderedAllCalled=false;counterPointApi=wp_pb.recommendationEnv&&wp_pb.recommendationEnv.COUNTERPOINT_API;log.debug("Finding containers");$container=$("#post-recommends");$container.hide();if(!$pbcontainer||$pbcontainer.length==0)$pbcontainer=$container.parent();if($container.length==1){log.debug("Setting up scroll listener");
if(document.location.toString().match(/\/lifestyle\/kidspost\//)){T.Events.smartPreload($pbcontainer,{});$pbcontainer.hide()}else T.Events.smartPreload($pbcontainer,{preload:_preload,visible:_visible,screens:2})}}catch(e){trackError("init-error")}})}_init()}if(wp_pb.StaticMethods.isPageHydrated())$(function(){_initEverything()});var shambleEvent=window.__e;shambleEvent.push(["shamble",function(){_initEverything()}])})();