(function($){window.console.log("Initialize USW");window.TWP=window.TWP||{};TWP.Identity=TWP.Identity||{};var showSignInWidget=function(){var isPWA=false;var signinUrl="https://www.washingtonpost.com/subscribe/signin/signin.html?tid\x3d"+TWP.Identity.uswTid;var originUrl="https://www.washingtonpost.com";if(window.location.host.indexOf("digitalink.com")!==-1){signinUrl="https://subscribe.digitalink.com/signin/signin.html?tid\x3d"+TWP.Identity.uswTid;originUrl="https://subscribe.digitalink.com"}else if(window.location.host.indexOf("pb-impact")!==
-1){signinUrl="https://www.washingtonpost.com/subscribe/stage/signin/signin.html?tid\x3d"+TWP.Identity.uswTid;originUrl="https://www.washingtonpost.com"}var jqConfig={url:signinUrl,overlay:'\x3cdiv id\x3d"wp_Signin" class\x3d"simple-overlay usw_Signin'+(isPWA?" is-pwa":"")+'"\x3e\x3cdiv class\x3d"usw-modal-content"\x3e\x3ciframe id\x3d"usw-iframe" src class\x3d"'+(isPWA?"is-pwa":"")+'" height\x3d"100%" width\x3d"100%" scrolling\x3d"'+(isPWA?"yes":"auto")+'" frameborder\x3d"0"\x3e\x3c/iframe\x3e\x3c/div\x3e\x3c/div\x3e',
overflowCss:"hidden",overlayConfig:{overlay:97,overlayClass:"wp_signin usw-signin"+(isPWA?" is-pwa":""),modal:true,closeClass:"usw-close-icon",toTop:true,trigger:".usw-close-icon",onShow:function(h){$("body").addClass("usw-modal-open");h.w.prependTo(h.o);if($(".pb-f-page-header-v2 .site-header.bar-hidden").length>0)$(".pb-f-page-header-v2 .site-header").removeClass("bar-hidden");h.o.css("z-index",1E11);h.w.css("z-index",100000000001);h.o.prependTo("body");if(typeof h.w.fadeIn=="function")h.w.fadeIn();
else h.w.show();setTimeout(function(){$("#wp_Signin").css("display","block");var uswIframe=document.getElementById("usw-iframe");uswIframe.removeAttribute("sandbox")},100);window.addEventListener("click",function(event){if(event.target===document.getElementsByClassName("usw-signin")[0])$overlay.jqmHide()},false);window.addEventListener("keyup",function(event){if(event.keyCode==27)$overlay.jqmHide()},false)},onHide:function(h){if(typeof h.w.fadeOut=="function")h.w.fadeOut("500",function(){h.o.remove()});
else{h.w.hide();h.o.remove()}$("body").removeClass("usw-modal-open")}}};TWP.Identity._loadModalCss();var $overlay=$(jqConfig.overlay);$overlay.jqm(jqConfig.overlayConfig);$overlay.find("iframe").attr("src",jqConfig.url);$overlay.jqmShow();function USWReceiveMessage(e){if(e.origin!==originUrl)return;if(e.data=="USW authenticated"){$overlay.jqmHide();if(window.TWP.originalUrl&&window.TWP.originalUrl!==window.location.href)window.location.href=window.TWP.originalUrl;else window.location.reload(true)}else if(e.data==
"USW close modal")$overlay.jqmHide()}window.addEventListener("message",USWReceiveMessage)};window.TWP.Identity.isUSWRegistered=false;function registerUSW(){if(!window.TWP.Identity.isUSWRegistered&&typeof $.fn.jqm!="undefined"){window.TWP.Identity.isUSWRegistered=true;$("#sign-in-link, #footer-signIn").click(function(event){event.preventDefault();if($(this).attr("id")=="sign-in-link")TWP.Identity.uswTid="usw_header";else if($(this).attr("id")==="footer-signIn")TWP.Identity.uswTid="usw_footer";var date=
new Date;var d=Date.parse(date);var url="https://www.washingtonpost.com/subscribe/universalsignin/auth-status?_v\x3d"+d;if(window.location.host.indexOf("digitalink.com")!==-1)url="https://subscribe.digitalink.com/universalsignin/auth-status?_v\x3d"+d;else if(window.location.host.indexOf("pb-impact")!==-1)url="https://subs-stage.washingtonpost.com/universalsignin/auth-status?_v\x3d"+d;$.ajax({url:url,dataType:"json",type:"GET",xhrFields:{withCredentials:true},success:function(resp){if(resp.status===
"SUCCESS")if(resp.signedIn)window.location.reload(true);else TWP.Identity._showSignIn();else TWP.Identity._showSignIn()},error:function(resp){TWP.Identity._showSignIn()}})})}}TWP.Identity._showSignIn=showSignInWidget;_waitForElement("wp-header",function(){registerUSW()});function _waitForElement(elementId,callBack){var element=document.getElementById(elementId);if(element)callBack(elementId,element);else window.setTimeout(function(){var element=document.getElementById(elementId);if(element)callBack(elementId,
element);else _waitForElement(elementId,callBack)},500)}})(window.Zepto||window.jQuery);